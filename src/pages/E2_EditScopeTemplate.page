<apex:page standardController="E2_Scope__c" extensions="E2_EditScopeTemplateController" action="{!pageAction}"
   showHeader="false" standardStylesheets="true" sidebar="false" applyHtmlTag="false" applyBodyTag="false">
   <html xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
      <head>
         <title>Edit Scope</title>
         <link type="text/css" rel="stylesheet" href="{!URLFOR($Resource.cloneany, '/slds/styles/salesforce-lightning-design-system-vf.min.css')}" />
         <link type="text/css" rel="stylesheet" href="{!URLFOR($Resource.cloneany, '/jstree/themes/proton/style.min.css')}" />
         <apex:includeScript value="{!URLFOR($Resource.cloneany, '/libs/jquery.js')}" />
         <apex:includeScript value="{!URLFOR($Resource.cloneany, '/jstree/jstree.min.js')}" />
         
         <apex:includeScript value="{!URLFOR($Resource.E2_TypeaheadResources, '/js/typeahead.bundle.js')}"/>
         <link type="text/css" rel="stylesheet" href="{!URLFOR($Resource.E2_TypeaheadResources, '/css/typeahead.css')}"/>
         
         <apex:includeScript value="../../soap/ajax/36.0/connection.js" />
         <apex:includeScript value="../../soap/ajax/15.0/apex.js" />
         <script>
             var treeId = "#relationShipTree";
             sforce.connection.sessionId='{!GETSESSIONID()}';
          </script>
         
         <apex:includeScript value="{!$Resource.E2_EditScopeTemplateJS}" />
         <style>
            .top {
                top:4px;
            }
            .paddingrightThree {
                padding-right:3px;
            }
            .slds-grid.slds-estimate-row .slds-col{
            width:50%;
            padding:1%;             
            }  
            .slds-table{
            width:100%;
            }    
            .slds-selection-background{
            background-color:#eee;
            }
            table tbody tr td select{
            width:100%;
            }
            .effort_slide, .story_slide, .assumption_slide{
            display:block;border-radius: 25px;border-style:solid;min-width: 45px;text-align: center;
            }
            .slide_background-selection{
            background:#73ad21!important;
            color:#fff!important; 
            }
            table tbody tr{
            vertical-align: top;
            }
            .slds-button--right--float{
            float:right;
            }
            .slds-float-left{
            float:left;
            }
            td.scope-description{  
            background: url({!$Resource.E2_SLDS1}/assets/icons/utility/edit_60.png) no-repeat scroll 90% 24px / 15px 15px;
            width:250px;
            }
            td.scope-description:hover{
            background: url({!$Resource.E2_SLDS1}/assets/icons/utility/edit_60.png) no-repeat scroll 90% 24px / 15px 15px;
            background-color: #faffbd!important;
            }
            th.is_favorite{
            /**background: #eef1f6 url({!$Resource.E2_SLDS1}/assets/icons/standard/endorsement_60.png) no-repeat scroll center center / 25px 25px;**/
            background: #faffbd url({!$Resource.E2_SLDS1}/assets/icons/action/new_custom11_120.png) no-repeat scroll center center / 25px 25px;
            padding-left: 0 !important;
            padding-right: 0 !important;
            width: 25px;
            }
            td.is_favorite {
            text-align: center;vertical-align: top;
            }
            th.is_active{
            /**background: #eef1f6 url({!$Resource.E2_SLDS1}/assets/icons/standard/task_60.png) no-repeat scroll center center / 25px 25px;**/
            background: #faffbd url({!$Resource.E2_SLDS1}/assets/icons/action/new_custom26_60.png) no-repeat scroll center center / 25px 25px;
            padding-left: 0 !important;
            padding-right: 0 !important;
            width: 25px;
            }
            td.is_active {
            text-align: center;vertical-align: top;
            }
            th.is_cloned{       
            padding-left: 0 !important;
            padding-right: 0 !important;
            width: 25px;
            }
            td.is_cloned {
            background: #faffbd url({!$Resource.E2_SLDS1}/assets/icons/action/clone_60.png) no-repeat scroll center center / 25px 25px;
            }
            a.delete_button{
            background: url({!$Resource.E2_SLDS1}/assets/icons/utility/delete_60.png) no-repeat scroll center center / 25px 25px;
            background-color: transparent;
            height: 25px;
            width: 25px;
            }
            a.edit-button{  
                background: url({!$Resource.E2_SLDS1}/assets/icons/utility/edit_60.png) no-repeat scroll center center / 25px 25px;
                background-color: transparent;
                height: 25px;
                width: 25px;
            }
            .table-row-display {
                display: table-row!important;
            }
            .whitespace_normal {
                white-space: normal!important;
            }
            td.scope-description ol, td.scope-description ul {
              list-style: inherit;
            }
            .slds .slds-table tr > td:first-child, .slds .slds-table tr > th:first-child {
                padding-left: 2px;
            }
            .slds .slds-table tr > td:last-child, .slds .slds-table tr > th:last-child {
               padding-right: 2px;
            }
            .slds .slds-table td, .slds .slds-table th {
               padding:2px;   
            } 
            .slds .slds-form-element__label {
                    color: #54698d;
                    display: inline-block;
                    font-size: 75%;
                    font-weight: bold;
                    line-height: 1.5;
                    margin-bottom: 0;
                    margin-right: 0;
            }
            div.scope-description ol, div.scope-description ul {
              list-style: inherit;
            }
             div.scope-description{  
                background: url({!$Resource.E2_SLDS1}/assets/icons/utility/edit_60.png) no-repeat scroll 90% 24px / 15px 15px;
                width:100%;
            }
            div.scope-description:hover{
                background: url({!$Resource.E2_SLDS1}/assets/icons/utility/edit_60.png) no-repeat scroll 90% 24px / 15px 15px;
                background-color: #faffbd!important;
            }
            .Typeahead {
                margin: 0 auto;
                width: 90%;
                min-width: 300px;
            }
            
            .Typeahead-hint{
                border:0px!important;
            }
            
            .ProfileCard-realName {
                font-weight: 600;
                font-size: 17px;
            }
            .slds-custom-badge-background-grey{
                background-color: #eee!important;
            }
         </style>
      </head>
      <body>
         <apex:form >
            <!-- REQUIRED SLDS WRAPPER -->
            <div class="slds">
              <div class="slds-notify_container" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                style = "display:none;">
                <div class="slds-notify slds-notify--toast slds-theme--success" id="sldsalertdiv" role="dialog">
                   <span class="slds-assistive-text">Success</span>
                   <button class="slds-button slds-button--icon-inverse slds-notify__close">
                      <svg aria-hidden="true" class="slds-button__icon slds-button__icon--large">
                         <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!$Resource.E2_SLDS1}/assets/icons/utility-sprite/svg/symbols.svg#close"></use>
                      </svg>
                      <span class="slds-assistive-text">Close</span>
                   </button>
                   <div class="notify__content slds-grid">
                      <svg aria-hidden="true" class="slds-icon slds-icon--small slds-m-right--small slds-col slds-no-flex">
                         <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!$Resource.E2_SLDS1}/assets/icons/utility-sprite/svg/symbols.svg#notification"></use>
                      </svg>
                      <div class="slds-col slds-align-middle">
                         <h2 class="slds-text-heading--small "></h2>
                      </div>
                   </div>
                </div>
             </div>
             <div role="dialog" class="slds-modal slds-fade-in-open slds-edit-alert" style="display:none;">
            <div class="slds-modal__container" tabindex="0">
              <div class="slds-modal__header" style="border-bottom:0px!important;">
                  <h2 class="slds-text-heading--small">Save Hierarchy</h2>
               </div>
              <div class="slds-modal__content">
                  <div class="slds-form-element paddingleft20" id="relationShipTree"></div>
              </div>
              <div class="slds-modal__footer">
                <button class="slds-button slds-button--neutral" onclick="return AddEditQuestionAnswer.hideJSTree();">Done</button>
              </div>
            </div>
          </div>
          <div class="slds-backdrop slds-backdrop--open slds-edit-alert-backdrop" style="display:none;"></div>
               <!-- PAGE HEADER -->
               <!-- / PAGE HEADER -->    
               <!-- PRIMARY CONTENT WRAPPER -->
               <div class="myapp">
                  <apex:pageMessages />
                  <apex:actionfunction action="{!saveScope}" name="AddOrUpdate"/>
                  <div class="slds-page-header" role="banner">
                     <div class="slds-grid">
                        <div class="slds-col slds-has-flexi-truncate">
                           <div class="slds-media">
                              <div class="slds-media__body">
                                 <p class="slds-text-heading--label"></p>
                                 <div class="slds-grid">
                                    <h1 class="slds-page-header__title slds-m-right--small slds-truncate slds-align-middle" title="Record Title">Scope Detail</h1>
                                 </div>
                              </div>
                           </div>
                        </div>
                        <div class="slds-col slds-no-flex slds-align-bottom">
                           <div class="slds-button-group" role="group">
                              
                              <apex:commandButton onclick="parent&&parent.AddEditScope&&parent.AddEditScope.reload_frame('/apex/E2_EditScopeTemplate?scopegroup_id={!scopeGrpId}&id={!scope.id}', window.name);return false;" styleClass="slds-button slds-button--neutral" title="Cancel" value="Cancel"/>
                              <apex:commandButton onclick="return addUpdateScopes();" styleClass="slds-button slds-button--neutral slds-button--brand" title="Save" value="Save" action="{!saveScope}"/>
                           </div>
                        </div>
                     </div>
                  </div>                 
                  <div>
                     <table class="slds-table slds-table--bordered slds-no-row-hover slds-max-medium-table--stacked scope-table">
                        <tbody>
                           <apex:repeat value="{!childScopes}" var="childscope">
                              <apex:outputpanel rendered="{!!childscope.isDeleted}">
                                <tr class="slds-hint-parent {!IF(childscope.slider_state == '', '', 'slds-selection-background')}">

                                    <td class="slds-truncate slds-size--1-of-3" data-label="Scope Name" title="{!childscope.scope.Name}">

                                       
                                        <div class="slds-form-element is-required ">
                                             <label class="slds-form-element__label">Name</label> 
                                             <div class="slds-form-element__control">
                                                <apex:inputfield styleclass="slds-input" value="{!childscope.scope.Name}" />
                                             </div>
                                             <div class="slds-form-element__help" style="display:none">This field is required</div>
                                          </div>
                                       
                                       <apex:inputHidden id="slider_state" value="{!childscope.slider_state}"/>
                                       
                                       
                                       
                                       <div class="slds-grid top">
                                          <div class="slds-col paddingrightThree">
                                                <div class="slds-form-element is-required " title="{!childscope.scope.Complexity__c}">
                                                     <label class="slds-form-element__label">Complexity</label>
                                                     <div class="slds-form-element__control">
                                                        <apex:inputfield id="scope-complexity" value="{!childscope.scope.Complexity__c}" styleclass="slds-select scope-complexity" rendered="{!NOT(is_View)}" >
        <!--                                                    <apex:actionSupport event="onchange" action="{!childscope.changeComplexity}"/> -->
                                                        </apex:inputfield>
                                                     </div>
                                                     <div class="slds-form-element__help" style="display:none">This field is required</div>
                                                </div>
                                          </div>
                                          <div class="slds-col">
                                                <div class="slds-form-element">
                                                  <label class="slds-form-element__label">Type</label>
                                                  <div class="slds-form-element__control">
                                                    
                                                      <apex:inputfield id="scope-itemtype" styleclass="slds-select scope-itemtype" value="{!childscope.scope.Scope_Item_Type__c}" rendered="{!NOT(is_View)}" />
                                                    
                                                  </div>
                                                </div>
                                          </div>
                                       </div>      
                                        
                                        <Br/>
                                        <div class="slds-grid">
                                        <apex:outputPanel layout="none" rendered="{!showFavForSTMPermissionSet}">
                                          <div class="slds-col">
                                                <div class="slds-form-element">
                                                  <div class="slds-form-element__control">
                                                    <label class="slds-checkbox">
                                                    
                                                      <apex:inputfield styleclass="slds-checkbox" value="{!childscope.scope.Is_Favourite__c}" rendered="{!NOT(is_View)}" />
                                                      <span class="slds-checkbox--faux"></span>
                                                      <span class="slds-form-element__label">Favorite</span>
                                                      
                                                    </label>
                                                  </div>
                                                </div>
                                          </div>
                                          </apex:outputPanel>
                                          <div class="slds-col">
                                             <div class="slds-form-element">
                                              <div class="slds-form-element__control">
                                                <label class="slds-checkbox">
                                                  <apex:inputfield styleclass="slds-checkbox" value="{!childscope.scope.Is_Active__c}" rendered="{!NOT(is_View)}" />
                                                  <span class="slds-checkbox--faux"></span>
                                                  <span class="slds-form-element__label">Active</span>
                                                </label>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                        <apex:inputField id="scope-flag" value="{!childscope.scope.Scope_Flag__c}" style="display:none;"/> 
                                    </td>

                                    <td data-label="" class="slds-truncate slds-size--2-of-3">
                                       <div class="slds-form-element" style="padding-left:0px;">
                                                  <label class="slds-form-element__label">Description</label>
                                                  <div class="slds-form-element__control scope-description">
                                                      <apex:inputTextarea id="richtext" richtext="true" cols="260" rows="8" value="{!childscope.scope.Description__c}" />
                                                      <apex:outputText style="padding:inherit;margin:inherit" id="outputtext" value="{!childscope.scope.Description__c}" escape="false"  />
                                                  </div>
                                       </div>    
                                       <div class="slds-form-element"  style="padding-left:0px;">
                                                  <label class="slds-form-element__label">Assumption</label>
                                                  <div class="slds-form-element__control scope-description">
                                                      <apex:inputTextarea id="assumptionRtext" richtext="true" cols="260" rows="8" value="{!childscope.scope.E2_Assumption__c}" />
                                                      <apex:outputText style="padding:inherit;margin:inherit" id="assumptiontext" value="{!childscope.scope.E2_Assumption__c}" escape="false"  />
                                                  </div>
                                       </div>    
                                       
                                    </td>
                                    <!--td data-label="Assumptions" class="scope-description slds-truncate slds-size--3-of-8">
                                       
                                    </td-->

                                 </tr>
                                 <tr class="slds-selection-background">
                                    <td colspan="3" style="padding:0px;">
                                       <div class="effortsdiv" style="margin-top:5px;display:{!IF(childscope.slider_state = 'effort', 'block', 'block')}">
                                          <span class="slds-badge slds-theme--default slds-float-left">Effort</span>
                                          <apex:commandbutton onclick="return validateData();" styleClass="slds-button slds-button--neutral slds-button--small slds-button--right--float" value="Add Effort" action="{!childscope.AddNewEffort}"/>
                                          <table class="slds-table slds-table--bordered slds-no-row-hover slds-max-medium-table--stacked ">
                                             <thead>
                                                <tr class="slds-text-heading--label slds-truncate slds-selection-background">
                                                   <!-- <th class="slds-is-sortable is_cloned" scope="col">
                                                      <div class="slds-truncate"></div>
                                                   </th> -->
                                                   <th class="slds-is-sortable" scope="col">
                                                      <div class="slds-truncate">Name<abbr class="slds-required" title="required">*</abbr></div>
                                                   </th>
                                                   <th class="slds-is-sortable" scope="col">
                                                      <div class="slds-truncate">Low (%)<abbr class="slds-required" title="required">*</abbr></div>
                                                   </th>
                                                   <th class="slds-is-sortable" scope="col">
                                                      <div class="slds-truncate">Effort Hrs<abbr class="slds-required" title="required">*</abbr></div>
                                                   </th>
                                                   <th class="slds-is-sortable" scope="col">
                                                      <div class="slds-truncate">High (%)<abbr class="slds-required" title="required">*</abbr></div>
                                                   </th>
                                                   <th class="slds-is-sortable" scope="col">
                                                      <div class="slds-truncate">Phase<abbr class="slds-required" title="required">*</abbr></div>
                                                   </th>
                                                   <th class="slds-is-sortable" scope="col">
                                                      <div class="slds-truncate">Role<abbr class="slds-required" title="required">*</abbr></div>
                                                   </th>
                                                   <th class="slds-is-sortable" scope="col">
                                                      <div class="slds-truncate">Speciality</div>
                                                   </th>
                                                   <th class="slds-is-sortable" scope="col">
                                                      <div class="slds-truncate"></div>
                                                   </th>
                                                </tr>
                                             </thead>
                                             <tbody>
                                                <apex:outputpanel rendered="{!IF(childscope.efforts.size = 0, true, false)}">
                                                    <tr><td colspan="9">No specified efforts defined!!!</td></tr>                                                                                                       
                                                </apex:outputpanel>
                                                <apex:repeat value="{!childscope.efforts}" var="effort">
                                                   <apex:outputpanel rendered="{!!effort.isDeleted}">
                                                      <tr class="slds-hint-parent slds-selection-background">
                                                         <!-- <td data-label="Cloned" class="slds-truncate {!IF(effort.isCloned = true,'is_cloned','')}" title="{!IF(effort.isCloned = true,'This is cloned effort','')}">
                                                         </td> -->
                                                         <td class="slds-truncate slds-size--1-of-8 whitespace_normal" data-label="Name"  title="{!effort.effort.Name}">
                                                            <apex:outputpanel rendered="{!NOT(effort.isCloned)}">
                                                               <div class="slds-form-element is-required whitespace_normal">
                                                                  <div class="slds-form-element__control">
                                                                     <apex:inputfield styleclass="slds-input" value="{!effort.effort.Name}" rendered="{!NOT(effort.isCloned)}"/>
                                                                  </div>
                                                                  <div class="slds-form-element__help" style="display:none">This field is required</div>
                                                               </div>
                                                            </apex:outputpanel>
                                                            <apex:outputfield value="{!effort.effort.Name}" rendered="{!effort.isCloned}"/>
                                                         </td>
                                                        <td class="slds-truncate slds-size--1-of-8" data-label="Low %">
                                                            <apex:outputpanel rendered="{!NOT(effort.isCloned)}">
                                                               <div class="slds-form-element is-required ">
                                                                  <div class="slds-form-element__control">
                                                                     <apex:inputfield styleclass="slds-input mandate-numeric" style="width:60px" value="{!effort.effort.Complexity_Factor_Low__c}" rendered="{!NOT(effort.isCloned)}"/>
                                                                  </div>
                                                                  <div class="slds-form-element__help" style="display:none">This field is required</div>
                                                               </div>
                                                            </apex:outputpanel>
                                                            <apex:outputfield value="{!effort.effort.Complexity_Factor_Low__c}" rendered="{!effort.isCloned}"/>
                                                         </td>
                                                         <td class="slds-truncate slds-size--1-of-8 effortsColumn" data-label="Effort Hrs">
                                                            <input type="hidden" class="oldhrs" value="{!effort.oldHrs}"/>
                                                            <div class="slds-form-element is-required ">
                                                               <div class="slds-form-element__control">
                                                                  <apex:inputfield styleclass="slds-input mandate-numeric" id="allocationHrs" style="width:60px" value="{!effort.effort.Effort_Hrs__c}" />
                                                               </div>
                                                               <div class="slds-form-element__help" style="display:none">This field is required</div>
                                                            </div>
                                                            <apex:outputpanel rendered="{!effort.isCloned}">
                                                               <div class="slds-form-element override-reason" style="{!IF(ISBLANK(effort.effort.Hrs_Override_Reason__c),'display:none;','')}">
                                                                  <label class="slds-form-element__label" for="textarea-input-01">Override Reason<abbr class="slds-required" title="required">*</abbr></label>                                   
                                                                  <div class="slds-form-element__control">
                                                                     <apex:inputfield styleclass="slds-textarea override-reason" value="{!effort.effort.Hrs_Override_Reason__c}"/>
                                                                  </div>
                                                                  <div class="slds-form-element__help" style="display:none">This field is required</div>
                                                               </div>
                                                            </apex:outputpanel>
                                                         </td>
                                                         <td class="slds-truncate slds-size--1-of-8" data-label="High %">
                                                            <apex:outputpanel rendered="{!NOT(effort.isCloned)}">
                                                               <div class="slds-form-element is-required ">
                                                                  <div class="slds-form-element__control">
                                                                     <apex:inputfield style="width:60px" styleclass="slds-input mandate-numeric" value="{!effort.effort.Complexity_Factor_High__c}" />
                                                                  </div>
                                                                  <div class="slds-form-element__help" style="display:none">This field is required</div>
                                                               </div>
                                                            </apex:outputpanel>
                                                            <apex:outputfield value="{!effort.effort.Complexity_Factor_High__c}" rendered="{!effort.isCloned}"/>
                                                         </td>
                                                         <td class="slds-truncate slds-size--1-of-8 whitespace_normal" data-label="Phase">
                                                            <apex:outputpanel rendered="{!NOT(effort.isCloned)}">
                                                               <div class="slds-form-element is-required">
                                                                  <div class="slds-form-element__control">
                                                                     <apex:inputfield styleclass="slds-select" value="{!effort.effort.Phase__c}" rendered="{!NOT(effort.isCloned)}"/>
                                                                  </div>
                                                                  <div class="slds-form-element__help"  style="display:none">This field is required</div>
                                                               </div>
                                                            </apex:outputpanel>
                                                            <apex:outputfield value="{!effort.effort.Phase__c}" rendered="{!effort.isCloned}"/>
                                                         </td>
                                                         <td class="slds-truncate slds-size--1-of-8 whitespace_normal" data-label="Role">
                                                            <apex:outputpanel rendered="{!NOT(effort.isCloned)}">
                                                               <div class="slds-form-element is-required ">
                                                                  <div class="slds-form-element__control">
                                                                     <apex:inputfield styleclass="slds-select" value="{!effort.effort.Resource_Role__c}" rendered="{!NOT(effort.isCloned)}"/>
                                                                  </div>
                                                                  <div class="slds-form-element__help" style="display:none">This field is required</div>
                                                               </div>
                                                            </apex:outputpanel>
                                                            <apex:outputfield value="{!effort.effort.Resource_Role__c}" rendered="{!effort.isCloned}"/>
                                                         </td>
                                                         <td class="slds-size--1-of-8 whitespace_normal" data-label="Speciality">
                                                            <apex:inputfield styleclass="slds-select" style="width:80%" value="{!effort.effort.Speciality__c}"/>
                                                             <!-- <apex:outputText value="{!effort.effort.Speciality__r.Name}" rendered="{!effort.isCloned}"/>-->
                                                         </td>
                                                         <td class="slds-cell-shrink" data-label="Actions">
                                                            <apex:commandlink immediate="true" styleClass="delete_button slds-button--right--float" rendered="{!NOT(is_View)}" value="" action="{!effort.remove}"/>
                                                         </td>
                                                      </tr>
                                                   </apex:outputpanel>
                                                </apex:repeat>
                                             </tbody>
                                          </table>
                                       </div>
                                    </td>
                                 </tr>
                                 <!-- Start: Cloned and slef question and answer section -->
                                 <tr class="slds-selection-background">
                                     <td colspan="3" style="padding:0px;">
                                       <div class="questiondiv" style="margin-top:5px;">
                                          <span class="slds-badge slds-theme--default slds-float-left" style="font-weight:bold;">Question &#38; Answer</span>
                                          <apex:commandbutton onclick="return validateDataQuestion();" styleClass="slds-button slds-button--neutral slds-button--small slds-button--right--float" value="Add Question" action="{!addNewQuestion}"/>
                                          <apex:outputPanel id="Questions">
                                          <table class="slds-table slds-table--bordered slds-no-row-hover slds-max-medium-table--stacked scope-table">
                                            <tbody>
                                                <apex:outputpanel rendered="{!IF(scopeQuestionManager.listQuestions.size = 0, true, false)}">
                                                    <tr><td colspan="9">No Q &#38; A records defined.</td></tr>                                                                                                       
                                                </apex:outputpanel>
                                                <apex:repeat value="{!scopeQuestionManager.listQuestions}" var="question">
                                                   <apex:outputpanel rendered="{!!question.isDeleted}">
                                                       <apex:outputpanel layout="none" rendered="{!question.e2question.Id != NULL}">
                                                      <tr class="slds-hint-parent slds-selection-background">
                                                          <td colspan="9">
                                                              <div class="slds-grid" id="{!question.e2question.id}">
                                                                  <div class="slds-col slds-size--{!IF(question.e2question.Type__c=='Picklist','5','7')}-of-9 whitespace_normal" title="{!question.e2question.Question_Text__c}" style="{!IF(question.e2question.Type__c=='Picklist','width:70%;','width:80%;')}">
                                                                    Q.&nbsp;<apex:outputfield value="{!question.e2question.Question_Text__c}"/>
                                                                    <apex:inputhidden value="{!question.selectedAnswer}" id="selectedAnswer" />
                                                                  </div>
                                                                  <apex:outputText escape="false" rendered="{!question.e2question.Type__c == 'Picklist'}">
                                                                  <div class="slds-col slds-size--2-of-9 whitespace_normal" title="{!question.e2question.Question_Text__c}">
                                                                    <div class="slds-form-element">
                                                                      <div class="slds-form-element__control">
                                                                          <select class="slds-select" onchange="AddEditQuestionAnswer.showActionAlert(this);">
                                                                              <option value="" questionid="{!question.e2question.id}" action="" loe="">None</option>
                                                                            <apex:repeat value="{!question.e2answers}" var="answer">
                                                                                <apex:outputText rendered="{!answer.e2answer.id == question.selectedAnswer}">
                                                                                    <option selected="true" value="{!answer.e2answer.id}" questionid="{!question.e2question.id}" action="{!answer.e2answer.Action__c}" loe="{!answer.e2answer.Effort_LOE__c}">{!answer.e2answer.Answer_Text__c}</option>    
                                                                                </apex:outputText>
                                                                                <apex:outputText rendered="{!answer.e2answer.id != question.selectedAnswer}">
                                                                                    <option value="{!answer.e2answer.id}" questionid="{!question.e2question.id}" action="{!answer.e2answer.Action__c}" loe="{!answer.e2answer.Effort_LOE__c}">{!answer.e2answer.Answer_Text__c}</option>    
                                                                                </apex:outputText>
                                                                            </apex:repeat>
                                                                            </select>
                                                                      </div>
                                                                   </div>
                                                                  </div>
                                                                  </apex:outputText>
                                                                 <div class="slds-col slds-size--1-of-9" data-label="Actions">
                                                                    <a class="edit-button slds-button--right--float" value="" onclick="return AddEditQuestionAnswer.showEditQuestionRow('question{!question.e2question.id}');" href="javascript:void(0);"/>
                                                                 </div>
                                                                 <div class="slds-col slds-size--1-of-9" data-label="Actions">
                                                                    <apex:commandlink styleClass="delete_button slds-button--right--float" rendered="{!NOT(is_View)}" value="" action="{!question.remove}"/>
                                                                 </div>
                                                              </div>
                                                              </td>
                                                            </tr>
                                                              <apex:outputpanel layout="none" rendered="{!AND(question.e2question.Type__c!='Picklist')}">
                                                                 <tr class="slds-hint-parent">
                                                                    <td colspan="9">
                                                                    <div class="slds-grid">
                                                                              <apex:outputpanel layout="none" rendered="{!question.e2question.Type__c=='Summary'}">
                                                                                  <apex:repeat value="{!question.e2answers}" var="answer">
                                                                                        <div class="slds-col slds-size--1-of-2">
                                                                                            <apex:inputTextarea styleClass="slds-textarea" value="{!answer.e2answer.Answer_Text__c}" html-placeholder="Enter your answer here."/>
                                                                                        </div>
                                                                                        <div class="slds-col slds-size--1-of-2"></div>
                                                                                  </apex:repeat>
                                                                            </apex:outputpanel>
                                                                              <apex:outputpanel layout="none" rendered="{!question.e2question.Type__c=='Checkbox'}">
                                                                                <apex:repeat value="{!question.e2answers}" var="answer">
                                                                                        <div class="slds-col slds-size--1-of-{!question.e2answers.size}">
                                                                                            <label class="slds-checkbox">
                                                                                            <apex:outputText rendered="{!answer.e2answer.Is_Selected__c}">
                                                                                                 <input checked="true" type="checkbox" name="{!question.e2question.id}answerscheckbox" questionid="{!question.e2question.id}" value="{!answer.e2answer.id}" action="{!answer.e2answer.Action__c}" loe="{!answer.e2answer.Effort_LOE__c}" onchange="AddEditQuestionAnswer.showActionAlert(this);"/>
                                                                                            </apex:outputText>
                                                                                            <apex:outputText rendered="{!!answer.e2answer.Is_Selected__c}">
                                                                                                <input type="checkbox" name="{!question.e2question.id}answerscheckbox" questionid="{!question.e2question.id}" value="{!answer.e2answer.id}" action="{!answer.e2answer.Action__c}" loe="{!answer.e2answer.Effort_LOE__c}" onchange="AddEditQuestionAnswer.showActionAlert(this);"/>    
                                                                                            </apex:outputText>
                                                                                            <span class="slds-checkbox--faux"></span>
                                                                                            <span class="slds-form-element__label">{!answer.e2answer.Answer_Text__c}</span>
                                                                                            </label>
                                                                                        </div>
                                                                                </apex:repeat>
                                                                            </apex:outputpanel>
                                                                            <apex:outputpanel layout="none" rendered="{!OR(question.e2question.Type__c=='Radiobutton',question.e2question.Type__c=='Yes/No')}">
                                                                                  <div class="slds-col slds-size--1-of-{!question.e2answers.size+1}">
                                                                                           <label class="slds-radio">
                                                                                              <input type="radio" name="{!question.e2question.id}answersradio"  questionid="{!question.e2question.id}" checked="true" value="" action="" loe="" onchange="AddEditQuestionAnswer.showActionAlert(this);"/>
                                                                                              <span class="slds-radio--faux"></span>
                                                                                              <span class="slds-form-element__label">None</span>
                                                                                           </label>
                                                                                        </div>
                                                                                  <apex:repeat value="{!question.e2answers}" var="answer">
                                                                                        <div class="slds-col slds-size--1-of-{!question.e2answers.size+1}">
                                                                                           <label class="slds-radio">
                                                                                              <apex:outputText rendered="{!answer.e2answer.Is_Selected__c}">
                                                                                                 <input checked="true" type="radio" onchange="AddEditQuestionAnswer.showActionAlert(this);" questionid="{!question.e2question.id}" name="{!question.e2question.id}answersradio" value="{!answer.e2answer.id}" action="{!answer.e2answer.Action__c}" loe="{!answer.e2answer.Effort_LOE__c}"/>
                                                                                            </apex:outputText>
                                                                                            <apex:outputText rendered="{!!answer.e2answer.Is_Selected__c}">
                                                                                                <input type="radio" onchange="AddEditQuestionAnswer.showActionAlert(this);" questionid="{!question.e2question.id}" name="{!question.e2question.id}answersradio" value="{!answer.e2answer.id}" action="{!answer.e2answer.Action__c}" loe="{!answer.e2answer.Effort_LOE__c}"/>
                                                                                            </apex:outputText>
                                                                                              <span class="slds-radio--faux"></span>
                                                                                              <span class="slds-form-element__label">{!answer.e2answer.Answer_Text__c}</span>
                                                                                           </label>
                                                                                        </div>
                                                                                </apex:repeat>
                                                                            </apex:outputpanel>
                                                                      </div>
                                                                      </td>
                                                                    </tr>
                                                              </apex:outputpanel>
                                                          
                                                      </apex:outputpanel>
                                                       <apex:outputpanel layout="none" rendered="{!!question.iscloned}">
                                                      <tr class="slds-hint-parent" id="question{!question.e2question.id}" style="display:{!IF(OR(question.e2question.id == NULL,question.isEdit),'table-row','none')};">
                                                        <td colspan="9">
                                                              <div class="slds-grid">
                                                                  <div class="slds-col slds-size--2-of-4">
                                                                    <div class="slds-form-element is-required whitespace_normal">
                                                                      <label class="slds-form-element__label">Question</label>
                                                                      <div class="slds-form-element__control">
                                                                         <apex:inputText styleclass="slds-input" value="{!question.e2question.Question_Text__c}" rendered="{!NOT(question.isCloned)}"/>
                                                                      </div>
                                                                      <div class="slds-form-element__help" style="display:none">This field is required</div>
                                                                   </div>
                                                                </div>
                                                                <div class="slds-col slds-size--1-of-4" style="padding-left:5px;">
                                                                    <div class="slds-form-element is-required whitespace_normal">
                                                                      <label class="slds-form-element__label">Type</label>
                                                                      <div class="slds-form-element__control">
                                                                         <apex:inputField styleclass="slds-select" value="{!question.e2question.Type__c}" rendered="{!NOT(question.isCloned)}" onchange="AddEditQuestionAnswer.checkSelectedQuestionType(this);"/><apex:commandButton style="display:none;" value="" action="{!question.addAnswer}"/>
                                                                      </div>
                                                                      <div class="slds-form-element__help" style="display:none">This field is required</div>
                                                                   </div>
                                                                </div>
                                                                <div class="slds-col slds-size--1-of-4" style="padding-left:5px;">
                                                                    <apex:commandlink immediate="true" styleClass="delete_button slds-button--right--float" rendered="{!question.e2question.id == NULL}" value="" action="{!question.remove}" style="padding:35px 30px 20px 20px;"/>
                                                                </div>
                                                              </div>
                                                        </td>
                                                      </tr>
                                                      <apex:repeat value="{!question.e2answers}" var="answer" rendered="{!question.e2question.Type__c != 'Summary'}">
                                                         <apex:outputpanel rendered="{!!answer.isDeleted}">
                                                        <tr class="slds-hint-parent slds-selection-background" id="question{!question.e2question.id}" style="display:{!IF(OR(question.e2question.id == NULL,question.isEdit),'table-row','none')};">
                                                          <td class="slds-size--8-of-9 whitespace_normal" title="{!answer.e2answer.Answer_Text__c}">
                                                            <div class="slds-grid">
                                                                <div class="slds-col slds-size--2-of-3">
                                                                    <div class="slds-form-element is-required whitespace_normal" style="padding-left:5px;">
                                                                      <label class="slds-form-element__label">Answer</label>
                                                                      <div class="slds-form-element__control">
                                                                         <apex:inputText styleclass="slds-input" value="{!answer.e2answer.Answer_Text__c}" rendered="{!NOT(answer.isCloned)}"/>
                                                                      </div>
                                                                      <div class="slds-form-element__help" style="display:none">This field is required</div>
                                                                   </div>
                                                                </div>
                                                                <div class="slds-col slds-size--1-of-3" style="padding-left:5px;">
                                                                    <div class="slds-grid">
                                                                      <div class="slds-col slds-size--2-of-3">
                                                                        <div class="slds-form-element whitespace_normal">
                                                                          <label class="slds-form-element__label">Action</label>
                                                                          <div class="slds-form-element__control">
                                                                             <apex:inputfield styleclass="slds-select" value="{!answer.e2answer.Action__c}" rendered="{!NOT(answer.isCloned)}" onchange="return AddEditQuestionAnswer.showJSTree(this);"/><apex:inputhidden value="{!answer.bindedScopes}" id="bindedScopes" />
                                                                          </div>
                                                                          <div class="slds-form-element__help" style="display:none">This field is required</div>
                                                                       </div>
                                                                      </div>
                                                                      <div class="slds-col slds-size--1-of-3" style="padding-left:5px;">
                                                                        <div class="slds-form-element whitespace_normal">
                                                                          <label class="slds-form-element__label">Effort LOE (%)</label>
                                                                          <div class="slds-form-element__control">
                                                                             <apex:inputfield styleclass="slds-input mandate-numeric" style="width:60px" value="{!answer.e2answer.Effort_LOE__c}" rendered="{!NOT(answer.isCloned)}"/>
                                                                          </div>
                                                                          <div class="slds-form-element__help" style="display:none">This field is required</div>
                                                                       </div>
                                                                      </div>
                                                                    </div>
                                                                </div>
                                                             </div>        
                                                            
                                                          </td>
                                                          <td class="slds-size--1-of-9 whitespace_normal" >
                                                            <apex:commandlink immediate="true" styleClass="delete_button slds-button--right--float" value="" action="{!answer.remove}" style="padding:35px 30px 20px 20px;"/>
                                                         </td>
                                                      </tr>
                                                      </apex:outputpanel>
                                                      </apex:repeat>
                                                      <apex:outputText rendered="{!question.e2question.Type__c != 'Summary'}">
                                                      <tr class="slds-hint-parent slds-selection-background" id="question{!question.e2question.id}" style="display:{!IF(OR(question.e2question.id == NULL,question.isEdit),'table-row','none')};">
                                                          <td colspan="9">
                                                             <apex:commandbutton onclick="return validateDataQuestion();" styleClass="slds-button slds-button--neutral slds-button--small slds-button--right--float" value="Add Answer" action="{!question.addNewAnswerInstance}"/>
                                                          </td>
                                                       </tr>          
                                                       </apex:outputText>
                                                      </apex:outputpanel>
                                                   </apex:outputpanel>
                                                   </apex:repeat>
                                            </tbody>
                                          </table>
                                          </apex:outputPanel>
                                          </div>
                                          </td>
                                 </tr>
                                 <!-- End: Cloned and slef question and answer section -->
                            </apex:outputpanel>
                                </apex:repeat>
                            </tbody>
                        </table>

                        <!-- Recommended Assets section -->
                        <div id="recommendedAssetsDiv" style="margin-top:10px;display:block;">
                            <span class="slds-badge slds-theme--default slds-float-left slds-custom-badge-background-grey" style="font-weight:bold;">Recommended Assets</span>
                            <br/>
                           
                            <div class="Typeahead">

                                <div class="u-posRelative">
                                    <input class="Typeahead-hint" type="text" readonly="" tabindex="-1" dir="ltr" />
                                    <input id="searchStr_ele" class="Typeahead-input" type="text" placeholder="Search and Add Assets..." name="q" autocomplete="off" spellcheck="false" dir="auto" />
                                    <img class="Typeahead-spinner" src="{!URLFOR($Resource.E2_SLDS1, '/assets/images/spinners/slds_spinner.gif')}" style="display: none;" />
                                    <!--button id="hideTypeahead" type="button" onclick="typeahead_input.hideTypeahead();" class="slds-button slds-button--neutral slds-button--small">Cancel</button-->
                                </div>
                                <div class="Typeahead-menu" style="max-height: 350px; overflow-y: auto;">
                                </div>

                            </div>

                            <table id="RecommendedAssetsTable" class="slds-table slds-table--bordered slds-no-row-hover slds-max-medium-table--stacked ">
                                <thead>
                                    <tr class="slds-text-heading--label slds-truncate slds-selection-background">
                                        <th class="slds-is-sortable" scope="col">
                                            <div class="slds-truncate">Asset Name</div>
                                        </th>
                                        <th class="slds-is-sortable" scope="col">
                                            <div class="slds-truncate">Short Description</div>
                                        </th>
                                        <!--th class="slds-is-sortable" scope="col">
                                            <div class="slds-truncate">Technologies</div>
                                        </th-->
                                        <th class="slds-is-sortable" scope="col">
                                            <div class="slds-truncate">Hours Saved</div>
                                        </th>
                                        <th class="slds-is-sortable" scope="col">
                                            <div class="slds-truncate">Release Stage</div>
                                        </th>
                                        <th class="slds-is-sortable" scope="col">
                                            <div class="slds-truncate"></div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!--apex:outputpanel rendered="{!IF(assetsRecsJson == '', true, false)}">
                                        <tr><td colspan="5">No recommended assets!!!</td></tr>                                                                                                       
                                    </apex:outputpanel-->
                                    <!--apex:repeat value="{!lstExistingAssets}" var="assetRec">
                                        <tr id="{!assetRec.id}">
                                            <td data-label="Asset Name">
                                                <div class="slds-truncate"><a href="/{!assetRec.id}" target="_blank">{!assetRec.assetName}</a></div>
                                            </td>
                                            <td data-label="Short Descripition">
                                                <div class="slds-truncate">{!assetRec.description}</div>
                                            </td-->
                                            <!--td data-label="Technologies">
                                                <div class="slds-truncate">{!assetRec.technologies}</div>
                                            </td-->
                                            <!--td data-label="Hours Saved">
                                                <div class="slds-truncate">{!(assetRec.totalHours - assetRec.reuseLoe)}</div>
                                            </td>
                                            <td data-label="Release Stage">
                                                <div class="slds-truncate">{!assetRec.releaseStage}</div>
                                            </td>
                                            <td class="slds-cell-shrink" data-label="Actions">
                                                <a onclick="typeahead_input.removeAssetRow('{!assetRec.id}');return false;" class="delete_button slds-button--right--float" />
                                            </td>
                                        </tr>
                                    </apex:repeat-->
                                </tbody>
                            </table>
                        </div>     
                                 
                  </div>
               </div>
               <!-- / PRIMARY CONTENT WRAPPER -->    
               <!-- FOOTER -->
               <div>
                  <div class="slds-modal__footer page-footer">
                     
                  </div>
                  <footer role="contentinfo" class="slds-p-around--large">
                     <div class="slds-grid slds-grid--align-spread">
                        <p class="slds-col">Estimator 2.0</p>
                        <p class="slds-col">&copy; Appirio</p>
                     </div>
                  </footer>
               </div>
               <!-- / FOOTER -->     
               <div id="loadingSpinner" class="slds-spinner_container" style="display: none !important;">
                  <div class="slds-spinner--brand slds-spinner slds-spinner--large" aria-hidden="false" role="alert">
                     <div class="slds-spinner__dot-a"></div>
                     <div class="slds-spinner__dot-b"></div>
                  </div>
               </div>
            </div>
            <!-- / REQUIRED SLDS WRAPPER -->    
            <!-- PLEASE DONOT REMOVE: This section is important while using standard controller -->
            <input type="hidden" value="{!E2_Scope__c.Name}"/> 
            <input type="hidden" value="{!E2_Scope__c.Complexity__c}"/>
            <input type="hidden" value="{!E2_Scope__c.Description__c}"/>
            <input type="hidden" value="{!E2_Scope__c.E2_Assumption__c}"/>
            <input type="hidden" value="{!E2_Scope__c.Parent_Scope__c}"/>
            <input type="hidden" value="{!E2_Scope__c.Scope_Group__c}"/>
            <input type="hidden" value="{!E2_Scope__c.Is_Favourite__c}"/>
            <input type="hidden" value="{!E2_Scope__c.LOE_Hrs__c}"/>
            <input type="hidden" value="{!E2_Scope__c.Presales_LOE__c}"/>
            
            <apex:inputhidden value="{!dmlOperationMessage}" id="dmlMessage" />
            <apex:inputhidden value="{!assetsRecsJson}" id="existingAssetRecs" />
         </apex:form>
      </body>
      <!-- JAVASCRIPT -->
      <script type="text/javascript">
         var msg = '{!dmlOperationMessage}'; 
         var scope_sfdc_id = '{!scope.id}';
         var scope_sfdc_name = '{!JSENCODE(scope.name)}';
         Typeahead_input.resourceUrl = '{!$Resource.E2_TypeaheadResources}';
      </script>
      <!-- / JAVASCRIPT -->    
   </html>
</apex:page>